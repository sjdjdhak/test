var C=Object.defineProperty,w=Object.defineProperties;var m=Object.getOwnPropertyDescriptors;var d=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var u=(r,e,t)=>e in r?C(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,c=(r,e)=>{for(var t in e||(e={}))I.call(e,t)&&u(r,t,e[t]);if(d)for(var t of d(e))S.call(e,t)&&u(r,t,e[t]);return r},f=(r,e)=>w(r,m(e));var i=(r,e,t)=>new Promise((s,a)=>{var v=o=>{try{l(t.next(o))}catch(h){a(h)}},p=o=>{try{l(t.throw(o))}catch(h){a(h)}},l=o=>o.done?s(o.value):Promise.resolve(o.value).then(v,p);l((t=t.apply(r,e)).next())});import{bU as N,I as y}from"./index-C8EcO_R4.js";const b=(...r)=>e=>{r.forEach(t=>{N(t)?t(e):t.value=e})};class E{getCategories(){return i(this,null,function*(){try{const e=yield fetch("/data/categories.json");if(!e.ok)throw new Error("Failed to fetch categories");return yield e.json()}catch(e){throw console.error("Error fetching categories:",e),e}})}createCategory(e){return i(this,null,function*(){return{id:`cat_${Date.now()}`,name:e.name,description:e.description||"",icon:e.icon||"",color:e.color||"#1890ff",order:e.order||1,parentId:e.parentId||null,level:0,isActive:!0,createTime:new Date().toISOString(),updateTime:new Date().toISOString(),children:[]}})}updateCategory(e,t){return i(this,null,function*(){return{id:e,name:t.name||"",description:t.description||"",icon:t.icon||"",color:t.color||"#1890ff",order:t.order||1,parentId:t.parentId||null,level:0,isActive:t.isActive!==void 0?t.isActive:!0,createTime:new Date().toISOString(),updateTime:new Date().toISOString(),children:[]}})}deleteCategory(e){return i(this,null,function*(){console.log("Deleting category:",e)})}reorderCategories(e){return i(this,null,function*(){console.log("Reordering categories:",e)})}}const g=new E,O=y("category",{state:()=>({categories:[],loading:!1,error:null,selectedCategoryId:null}),getters:{categoryTree(){return this.buildCategoryTree(this.categories)},flatCategories(){return this.flattenCategories(this.categories)},totalCount(){return this.flatCategories.length},rootCategories(){return this.categories.filter(r=>!r.parentId)},getCategoryById(){return r=>this.flatCategories.find(e=>e.id===r)},getChildCategories(){return r=>this.categories.filter(e=>e.parentId===r)},getCategoryPath(){return r=>{const e=[];let t=this.getCategoryById(r);for(;t;)e.unshift(t),t=t.parentId?this.getCategoryById(t.parentId):void 0;return e}}},actions:{fetchCategories(){return i(this,null,function*(){this.loading=!0,this.error=null;try{const r=yield g.getCategories();this.categories=r.categories}catch(r){this.error=r instanceof Error?r.message:"获取分类失败",console.error("Failed to fetch categories:",r)}finally{this.loading=!1}})},createCategory(r){return i(this,null,function*(){try{const e=yield g.createCategory(r);return this.categories.push(e),e}catch(e){throw this.error=e instanceof Error?e.message:"创建分类失败",e}})},updateCategory(r,e){return i(this,null,function*(){try{const t=yield g.updateCategory(r,e),s=this.categories.findIndex(a=>a.id===r);return s!==-1&&(this.categories[s]=t),t}catch(t){throw this.error=t instanceof Error?t.message:"更新分类失败",t}})},deleteCategory(r){return i(this,null,function*(){try{yield g.deleteCategory(r),this.categories=this.categories.filter(e=>e.id!==r)}catch(e){throw this.error=e instanceof Error?e.message:"删除分类失败",e}})},setSelectedCategory(r){this.selectedCategoryId=r},buildCategoryTree(r,e=null){return r.filter(t=>t.parentId===e).sort((t,s)=>t.order-s.order).map(t=>f(c({},t),{children:this.buildCategoryTree(r,t.id),expanded:!1,selected:t.id===this.selectedCategoryId,disabled:!t.isActive}))},flattenCategories(r){const e=[],t=s=>{s.forEach(a=>{e.push(a),a.children&&a.children.length>0&&t(a.children)})};return t(r),e},clearError(){this.error=null}}});class T{getNavigations(e){return i(this,null,function*(){try{const t=yield fetch("/data/navigation_001.json");if(!t.ok)throw new Error("Failed to fetch navigations");const s=yield t.json();return{items:s.items,total:s.meta.totalItems,page:1,pageSize:s.items.length}}catch(t){throw console.error("Error fetching navigations:",t),t}})}createNavigation(e){return i(this,null,function*(){return{id:`nav_${Date.now()}`,title:e.title,description:e.description,url:e.url,icon:e.icon||"",categoryId:e.categoryId,tags:e.tags||[],featured:e.featured||!1,isActive:!0,visitCount:0,rating:0,createTime:new Date().toISOString(),updateTime:new Date().toISOString()}})}updateNavigation(e,t){return i(this,null,function*(){return{id:e,title:t.title||"",description:t.description||"",url:t.url||"",icon:t.icon||"",categoryId:t.categoryId||"",tags:t.tags||[],featured:t.featured||!1,isActive:t.isActive!==void 0?t.isActive:!0,visitCount:0,rating:0,createTime:new Date().toISOString(),updateTime:new Date().toISOString()}})}deleteNavigation(e){return i(this,null,function*(){console.log("Deleting navigation:",e)})}batchImport(e){return i(this,null,function*(){return{success:e.length,failed:0,errors:[]}})}search(e,t){return i(this,null,function*(){return console.log("Searching navigations:",e,t),[]})}getFeaturedNavigations(){return i(this,null,function*(){return(yield this.getNavigations()).items.filter(t=>t.featured)})}getPopularNavigations(){return i(this,null,function*(){return(yield this.getNavigations()).items.sort((t,s)=>s.visitCount-t.visitCount).slice(0,10)})}incrementVisitCount(e){return i(this,null,function*(){console.log("Incrementing visit count for:",e)})}}const n=new T,z=y("navigation",{state:()=>({navigations:[],loading:!1,error:null,currentPage:1,pageSize:20,total:0,searchQuery:"",selectedCategoryId:null,filters:{featured:!1,tags:[],rating:null}}),getters:{currentNavigations(){const r=(this.currentPage-1)*this.pageSize,e=r+this.pageSize;return this.filteredNavigations.slice(r,e)},filteredNavigations(){let r=[...this.navigations];if(this.selectedCategoryId&&(r=r.filter(e=>e.categoryId===this.selectedCategoryId)),this.searchQuery){const e=this.searchQuery.toLowerCase();r=r.filter(t=>t.title.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.tags.some(s=>s.toLowerCase().includes(e)))}return this.filters.featured&&(r=r.filter(e=>e.featured)),this.filters.tags.length>0&&(r=r.filter(e=>this.filters.tags.some(t=>e.tags.includes(t)))),this.filters.rating&&(r=r.filter(e=>e.rating>=this.filters.rating)),r},totalCount(){return this.navigations.length},totalPages(){return Math.ceil(this.filteredNavigations.length/this.pageSize)},getNavigationById(){return r=>this.navigations.find(e=>e.id===r)},featuredNavigations(){return this.navigations.filter(r=>r.featured).slice(0,10)},popularNavigations(){return[...this.navigations].sort((r,e)=>e.visitCount-r.visitCount).slice(0,10)},allTags(){const r=new Set;return this.navigations.forEach(e=>{e.tags.forEach(t=>r.add(t))}),Array.from(r).sort()}},actions:{fetchNavigations(r){return i(this,null,function*(){this.loading=!0,this.error=null;try{const e=yield n.getNavigations(r);this.navigations=e.items,this.total=e.total}catch(e){this.error=e instanceof Error?e.message:"获取导航失败",console.error("Failed to fetch navigations:",e)}finally{this.loading=!1}})},searchNavigations(r,e){return i(this,null,function*(){this.searchQuery=r,e&&(this.filters=c(c({},this.filters),e)),this.currentPage=1})},setCategoryFilter(r){this.selectedCategoryId=r,this.currentPage=1},setCurrentPage(r){this.currentPage=r},setPageSize(r){this.pageSize=r,this.currentPage=1},clearSearch(){this.searchQuery="",this.filters={featured:!1,tags:[],rating:null},this.currentPage=1},createNavigation(r){return i(this,null,function*(){try{const e=yield n.createNavigation(r);return this.navigations.unshift(e),this.total+=1,e}catch(e){throw this.error=e instanceof Error?e.message:"创建导航失败",e}})},updateNavigation(r,e){return i(this,null,function*(){try{const t=yield n.updateNavigation(r,e),s=this.navigations.findIndex(a=>a.id===r);return s!==-1&&(this.navigations[s]=t),t}catch(t){throw this.error=t instanceof Error?t.message:"更新导航失败",t}})},deleteNavigation(r){return i(this,null,function*(){try{yield n.deleteNavigation(r),this.navigations=this.navigations.filter(e=>e.id!==r),this.total-=1}catch(e){throw this.error=e instanceof Error?e.message:"删除导航失败",e}})},batchImport(r){return i(this,null,function*(){try{const e=yield n.batchImport(r);return yield this.fetchNavigations(),e}catch(e){throw this.error=e instanceof Error?e.message:"批量导入失败",e}})},incrementVisitCount(r){const e=this.navigations.find(t=>t.id===r);e&&(e.visitCount+=1)},clearError(){this.error=null}}});export{z as a,b as c,O as u};
