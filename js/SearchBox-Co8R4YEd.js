import{E as R,f as W,l as C,v as X,t as Y,e as Z}from"./_plugin-vue_export-helper-DAE0c8RX.js";import{a as q,b as ee}from"./el-input-B5lZdLQh.js";import{d as se,f as m,c as te,D as H,x as oe,E as ae,a as i,n as L,u as o,h as d,b as k,J as le,y as ne,w as h,g as p,F as M,q as N,o as r,l as x,i as z,p as re,t as b}from"./index-C8EcO_R4.js";const ce={key:0,class:"search-suggestions"},ue={class:"suggestions-header"},ie={class:"suggestions-list"},de=["onClick","onMouseenter"],he={class:"suggestion-text"},pe={key:0,class:"suggestion-count"},ve={key:1,class:"hot-searches"},fe={class:"hot-searches-header"},me={class:"hot-searches-tags"},ge=se({__name:"SearchBox",props:{modelValue:{default:""},placeholder:{default:"搜索导航..."},size:{default:"default"},showSuggestions:{type:Boolean,default:!0},showHotSearches:{type:Boolean,default:!0},maxSuggestions:{default:8}},emits:["update:modelValue","search","focus","blur"],setup(T,{emit:J}){const _=T,S=J,t=m(_.modelValue),v=m(!1),a=m(-1),c=m([]),g=m([]),w=m(["ChatGPT","Midjourney","Stable Diffusion","Claude","Copilot","文本生成","图像生成","代码助手","翻译工具","语音识别"]),V=te(()=>_.showSuggestions&&v.value&&t.value.length>0);H(()=>_.modelValue,e=>{t.value=e}),H(t,e=>{S("update:modelValue",e)});const K=e=>{t.value=e,E(e)},O=()=>{v.value=!0,S("focus"),I(),t.value&&E(t.value)},U=()=>{setTimeout(()=>{v.value=!1,a.value=-1},200),S("blur")},y=()=>{t.value.trim()&&(j(t.value.trim()),S("search",t.value.trim()),v.value=!1)},$=()=>{t.value="",c.value=[],a.value=-1},B=e=>{t.value=e.text,y()},A=e=>{t.value=e,y()},E=e=>{if(!e.trim()){c.value=[];return}const s=g.value.filter(l=>l.toLowerCase().includes(e.toLowerCase())).slice(0,4).map(l=>({text:l,type:"history"})),u=w.value.filter(l=>l.toLowerCase().includes(e.toLowerCase())).slice(0,4).map(l=>({text:l,type:"suggestion"}));c.value=[...s,...u].slice(0,_.maxSuggestions)},I=()=>{try{const e=localStorage.getItem("search-history");e&&(g.value=JSON.parse(e))}catch(e){console.error("Failed to load search history:",e)}},j=e=>{try{const s=[...g.value],u=s.indexOf(e);u>-1&&s.splice(u,1),s.unshift(e),s.splice(10),g.value=s,localStorage.setItem("search-history",JSON.stringify(s))}catch(s){console.error("Failed to save search history:",s)}},G=()=>{g.value=[],localStorage.removeItem("search-history"),c.value=[]},D=e=>{if(V.value)switch(e.key){case"ArrowDown":e.preventDefault(),a.value=Math.min(a.value+1,c.value.length-1);break;case"ArrowUp":e.preventDefault(),a.value=Math.max(a.value-1,-1);break;case"Enter":e.preventDefault(),a.value>=0?B(c.value[a.value]):y();break;case"Escape":v.value=!1,a.value=-1;break}};return oe(()=>{document.addEventListener("keydown",D),I()}),ae(()=>{document.removeEventListener("keydown",D)}),(e,s)=>{const u=W,l=R,P=q,Q=ee;return r(),i("div",{class:L(["search-box",{"search-box--focused":o(v)}])},[d(P,{modelValue:o(t),"onUpdate:modelValue":s[0]||(s[0]=n=>ne(t)?t.value=n:null),placeholder:e.placeholder,size:e.size,clearable:"",onInput:K,onFocus:O,onBlur:U,onKeyup:le(y,["enter"]),onClear:$,class:"search-input"},{prefix:h(()=>[d(u,{class:"search-icon"},{default:h(()=>[d(o(C))]),_:1})]),suffix:h(()=>[o(t)?(r(),x(l,{key:0,type:"primary",icon:o(C),onClick:y,class:"search-btn"},null,8,["icon"])):k("",!0)]),_:1},8,["modelValue","placeholder","size"]),o(V)&&o(c).length>0?(r(),i("div",ce,[p("div",ue,[s[2]||(s[2]=p("span",{class:"suggestions-title"},"搜索建议",-1)),d(l,{type:"text",onClick:G,class:"clear-btn"},{default:h(()=>s[1]||(s[1]=[z("清除历史")])),_:1,__:[1]})]),p("ul",ie,[(r(!0),i(M,null,N(o(c),(n,f)=>(r(),i("li",{key:f,class:L(["suggestion-item",{"suggestion-item--active":f===o(a)}]),onClick:F=>B(n),onMouseenter:F=>a.value=f},[d(u,{class:"suggestion-icon"},{default:h(()=>[(r(),x(re(n.type==="history"?o(X):o(C))))]),_:2},1024),p("span",he,b(n.text),1),n.count?(r(),i("span",pe,b(n.count),1)):k("",!0)],42,de))),128))])])):k("",!0),e.showHotSearches&&o(w).length>0?(r(),i("div",ve,[p("div",fe,[d(u,null,{default:h(()=>[d(o(Y))]),_:1}),s[3]||(s[3]=p("span",null,"热门搜索",-1))]),p("div",me,[(r(!0),i(M,null,N(o(w),(n,f)=>(r(),x(Q,{key:f,type:f<3?"danger":"info",onClick:F=>A(n),class:"hot-search-tag"},{default:h(()=>[z(b(n),1)]),_:2},1032,["type","onClick"]))),128))])])):k("",!0)],2)}}}),ke=Z(ge,[["__scopeId","data-v-e02194d8"]]);export{ke as S};
