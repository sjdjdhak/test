var B=(E,T,e)=>new Promise((d,_)=>{var c=r=>{try{p(e.next(r))}catch(y){_(y)}},N=r=>{try{p(e.throw(r))}catch(y){_(y)}},p=r=>r.done?d(r.value):Promise.resolve(r.value).then(c,N);p((e=e.apply(E,T)).next())});import{f as H,I as P,E as Q,J as V,r as X,i as Y,L as M,M as Z,A as x,j as tt,k as at,e as et}from"./_plugin-vue_export-helper-DAE0c8RX.js";import{a as ot}from"./el-rate-CX40KGOT.js";import{b as nt}from"./el-input-B5lZdLQh.js";/* empty css                        */import{a as it,b as st,E as lt}from"./el-skeleton-item-CzrWbPsQ.js";import{d as rt,f as dt,c as C,x as ct,a as v,o as s,n as S,g as n,b as g,l as f,w as i,h as l,u as o,t as m,m as b,i as u,F as gt,q as ut}from"./index-C8EcO_R4.js";import{u as vt}from"./navigation-7vtA9nYp.js";import{E as z}from"./el-select-CaBiTLQY.js";const mt={class:"card-header"},ft={class:"site-info"},_t={class:"site-icon"},pt=["src","alt"],yt={class:"site-details"},kt={class:"site-title"},ht={class:"site-url"},wt={class:"card-actions"},Ct={class:"card-content"},bt={class:"site-description"},Et={key:0,class:"tags-container"},Tt={class:"card-footer"},Nt={class:"stats"},It={class:"stat-item"},Bt={key:0,class:"stat-item"},Dt={class:"category-tag"},Ft={key:0,class:"featured-badge"},Vt={key:1,class:"new-badge"},Mt=rt({__name:"NavigationCard",props:{navigation:{},showFavorite:{type:Boolean,default:!0},showEdit:{type:Boolean,default:!1},maxTags:{default:3}},emits:["click","favorite","tagClick","categoryClick","edit","delete"],setup(E,{emit:T}){const e=E,d=T,_=vt(),c=dt(!1),N=C(()=>e.navigation.tags.slice(0,e.maxTags)),p=C(()=>{const t=_.getCategoryById(e.navigation.categoryId);return(t==null?void 0:t.name)||"未分类"}),r=C(()=>{const t=_.getCategoryById(e.navigation.categoryId);return(t==null?void 0:t.color)||"#909399"}),y=C(()=>{const t=new Date(e.navigation.createTime);return(new Date().getTime()-t.getTime())/(1e3*60*60*24)<=7}),j=()=>{d("click",e.navigation)},L=t=>{const a=t.target;a.style.display="none"},O=t=>{try{return new URL(t).hostname}catch(a){return t}},U=t=>t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"K":t.toString(),A=()=>{c.value=!c.value,d("favorite",e.navigation,c.value)},J=t=>{d("tagClick",t)},R=()=>{d("categoryClick",e.navigation.categoryId)},q=t=>{switch(t){case"visit":window.open(e.navigation.url,"_blank");break;case"copy":D(e.navigation.url);break;case"share":K();break;case"edit":d("edit",e.navigation);break;case"delete":d("delete",e.navigation);break}},D=t=>B(this,null,function*(){try{yield navigator.clipboard.writeText(t),z.success("链接已复制到剪贴板")}catch(a){z.error("复制失败")}}),K=()=>B(this,null,function*(){if(navigator.share)try{yield navigator.share({title:e.navigation.title,text:e.navigation.description,url:e.navigation.url})}catch(t){}else D(e.navigation.url)});return ct(()=>{const t=JSON.parse(localStorage.getItem("favorites")||"[]");c.value=t.includes(e.navigation.id)}),(t,a)=>{const w=H,F=Q,k=st,W=it,$=lt,I=nt,G=ot;return s(),v("div",{class:S(["navigation-card",{"navigation-card--featured":t.navigation.featured,"navigation-card--inactive":!t.navigation.isActive}]),onClick:j},[n("div",mt,[n("div",ft,[n("div",_t,[t.navigation.icon?(s(),v("img",{key:0,src:t.navigation.icon,alt:t.navigation.title,onError:L,class:"icon-img"},null,40,pt)):(s(),f(w,{key:1,class:"icon-placeholder"},{default:i(()=>[l(o(P))]),_:1}))]),n("div",yt,[n("h3",kt,m(t.navigation.title),1),n("p",ht,m(O(t.navigation.url)),1)])]),n("div",wt,[t.showFavorite?(s(),f(F,{key:0,type:"text",icon:o(c)?o(V):o(X),class:S([{favorited:o(c)},"action-btn favorite-btn"]),onClick:b(A,["stop"])},null,8,["icon","class"])):g("",!0),l($,{onCommand:q,trigger:"click"},{dropdown:i(()=>[l(W,null,{default:i(()=>[l(k,{command:"visit",icon:o(M)},{default:i(()=>a[2]||(a[2]=[u("访问网站")])),_:1,__:[2]},8,["icon"]),l(k,{command:"copy",icon:o(Z)},{default:i(()=>a[3]||(a[3]=[u("复制链接")])),_:1,__:[3]},8,["icon"]),l(k,{command:"share",icon:o(x)},{default:i(()=>a[4]||(a[4]=[u("分享")])),_:1,__:[4]},8,["icon"]),t.showEdit?(s(),f(k,{key:0,command:"edit",icon:o(tt),divided:""},{default:i(()=>a[5]||(a[5]=[u("编辑")])),_:1,__:[5]},8,["icon"])):g("",!0),t.showEdit?(s(),f(k,{key:1,command:"delete",icon:o(at)},{default:i(()=>a[6]||(a[6]=[u("删除")])),_:1,__:[6]},8,["icon"])):g("",!0)]),_:1})]),default:i(()=>[l(F,{type:"text",icon:o(Y),class:"action-btn",onClick:a[0]||(a[0]=b(()=>{},["stop"]))},null,8,["icon"])]),_:1})])]),n("div",Ct,[n("p",bt,m(t.navigation.description),1),t.navigation.tags.length>0?(s(),v("div",Et,[(s(!0),v(gt,null,ut(o(N),h=>(s(),f(I,{key:h,size:"small",class:"tag-item",onClick:b(St=>J(h),["stop"])},{default:i(()=>[u(m(h),1)]),_:2},1032,["onClick"]))),128)),t.navigation.tags.length>t.maxTags?(s(),f(I,{key:0,size:"small",type:"info",class:"tag-more"},{default:i(()=>[u(" +"+m(t.navigation.tags.length-t.maxTags),1)]),_:1})):g("",!0)])):g("",!0)]),n("div",Tt,[n("div",Nt,[n("div",It,[l(w,null,{default:i(()=>[l(o(M))]),_:1}),n("span",null,m(U(t.navigation.visitCount)),1)]),t.navigation.rating>0?(s(),v("div",Bt,[l(G,{modelValue:t.navigation.rating,"onUpdate:modelValue":a[1]||(a[1]=h=>t.navigation.rating=h),disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value}",size:"small",class:"rating"},null,8,["modelValue"])])):g("",!0)]),n("div",Dt,[l(I,{color:o(r),effect:"light",size:"small",onClick:b(R,["stop"])},{default:i(()=>[u(m(o(p)),1)]),_:1},8,["color"])])]),t.navigation.featured?(s(),v("div",Ft,[l(w,null,{default:i(()=>[l(o(V))]),_:1}),a[7]||(a[7]=n("span",null,"推荐",-1))])):g("",!0),o(y)?(s(),v("div",Vt,a[8]||(a[8]=[n("span",null,"NEW",-1)]))):g("",!0)],2)}}}),Kt=et(Mt,[["__scopeId","data-v-4f384081"]]);export{Kt as N};
